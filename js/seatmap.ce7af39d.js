(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["seatmap"],{"0c15":function(t,e,s){"use strict";var a=s("31f3"),n=s.n(a);n.a},"1caf":function(t,e,s){"use strict";var a=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"NDT-Seatmap"},[s("b-container",[t.readOnly?t._e():s("div",{staticClass:"NDT-Seatmap__Loader",class:{"NDT-Seatmap__Loader--show":t.reserving||t.mySeat}},[t.reserving?[s("h5",[s("icon",{staticClass:"NDT-Seatmap__Loading__Spinner",attrs:{spin:"",icon:"spinner"}}),t._v("\n          Oppdaterer reservasjon\n        ")],1)]:[t.mySeatAvailable?[s("h5",{staticClass:"NDT-Seatmap__Reservation"},[s("b-button",{staticClass:"NDT-Seatmap__Reservation__Delete",attrs:{variant:"danger",size:"sm"},on:{click:t.clearReservation}},[s("icon",{staticClass:"NDT-Seatmap__Reservation__Delete__Icon",attrs:{icon:"trash"}}),t._v("\n               Slett reservasjon\n            ")],1),t._v("\n             \n            "),s("vue-countdown",{attrs:{time:t.reservationTime},on:{countdownend:t.fetchSeatmap},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v("\n                Reservasjon utløper "+t._s(e.minutes)+":"+t._s(e.seconds))]}}])})],1)]:[s("h5",[t._v(" ")])]]],2)]),!t.seats.length||t.fetchingSeatmap?[s("h5",[s("icon",{staticClass:"NDT-Seatmap__Loading__Spinner",attrs:{spin:"",icon:"spinner"}}),t._v("\n      Henter kart...\n    ")],1)]:[s("section",{staticClass:"NDT-Seatmap__Available"},[t._v("\n      "+t._s(t.available)+" av "+t._s(t.seats.length)+" plasser ledig\n    ")]),t.explanation?[s("section",{staticClass:"NDT-Seatmap__Explanation"},[s("div",{staticClass:"NDT-Seatmap__Preview"},[s("ndt-seat",{attrs:{"seat-type":"free"}}),s("span",[t._v("Ledig")])],1),s("div",{staticClass:"NDT-Seatmap__Preview"},[s("ndt-seat",{attrs:{"seat-type":"taken","my-seat":""}}),s("span",[t._v("Min plass")])],1),s("div",{staticClass:"NDT-Seatmap__Preview"},[s("ndt-seat",{attrs:{"seat-type":"disabled"}}),s("span",[t._v("Reservert")])],1),s("div",{staticClass:"NDT-Seatmap__Preview"},[s("ndt-seat",{attrs:{"seat-type":"taken"}}),s("span",[t._v("Bestilt")])],1)])]:t._e(),s("div",{staticClass:"NDT-Seatmap__Seatmap"},t._l(t.height,function(e){return s("div",{key:"row-"+(e-1),staticClass:"NDT-Seatmap__Row"},t._l(t.width,function(a){return s("div",{key:"row-"+(a-1),staticClass:"NDT-Seatmap__Column"},[s("ndt-seat",{attrs:{x:a-1,y:e-1,reserving:t.reserving,"my-seat":t.mySeat&&t.mySeat.x===a-1&&t.mySeat.y===e-1,readOnly:t.readOnly},on:{reserve:t.reserve,reserved:t.reserved}})],1)}))}))]],2)},n=[],i=(s("96cf"),s("3040")),r=s("c93e"),o=s("2f62"),u=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{directives:[{name:"b-tooltip",rawName:"v-b-tooltip"}],staticClass:"NDT-Seat",class:t.seatClass,attrs:{title:t.seatTitle},on:{click:t.reserve}})},c=[],h=(s("7514"),s("c5f6"),{name:"NDTSeat",props:{readOnly:{type:Boolean,default:!1},x:{type:Number,default:null},y:{type:Number,default:null},seatType:{type:String,default:null},mySeat:{type:Boolean,default:!1},reserving:!1},data:function(t){return{isReserving:!1}},computed:Object(r["a"])({},Object(o["c"])({seats:"seatmap/seats",token:"auth/token",user:"user/user"}),{seat:function(){var t=this;return this.seats.find(function(e){var s=e.x,a=e.y;return s===t.x&&a===t.y})},seatClass:function(){var t=this.seat,e=this.seatType;this.user;return{"NDT-Seat--Free":"free"===e||t&&"free"===t.status,"NDT-Seat--Taken":"taken"===e||t&&"taken"===t.status,"NDT-Seat--Disabled":!this.mySeat&&("disabled"===e||t&&"reserved"===t.status),"NDT-Seat--Reserving":this.reserving,"NDT-Seat--MySeat":this.mySeat}},seatTitle:function(){return!!this.seat&&(this.seat.user?this.user&&this.seat.user[0]===this.user.id?"Rad: ".concat(this.seat.row,", Plass: ").concat(this.seat.seat," (Min reservasjon)"):"Rad: ".concat(this.seat.row,", Plass: ").concat(this.seat.seat," (").concat(this.seat.user[1],")"):"Rad: ".concat(this.seat.row,", Plass: ").concat(this.seat.seat))}}),methods:Object(r["a"])({},Object(o["b"])({setSeats:"seatmap/setSeats",setWidth:"seatmap/setWidth",setHeight:"seatmap/setHeight",showAuth:"modals/showAuth"}),{reserve:function(){var t=Object(i["a"])(regeneratorRuntime.mark(function t(){var e,s;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:if(this.readOnly){t.next=29;break}if(this.user){t.next=5;break}this.showAuth(),t.next=29;break;case 5:if(this.mySeat){t.next=29;break}if(!("free"===this.seat.status||this.user&&this.seat.user&&this.seat.user[0]===this.user.id)){t.next=29;break}return this.isReserving=!0,this.$emit("reserve",!0),t.prev=9,t.next=12,this.$api.put("seatmap/reserve/".concat(this.seat.id),{owner:this.token});case 12:return e=t.sent,t.next=15,this.$api.get("seatmap");case 15:s=t.sent,this.setSeats(s.seats),this.setWidth(s.width),this.setHeight(s.height),e&&this.$emit("reserved",this.seat),t.next=25;break;case 22:t.prev=22,t.t0=t["catch"](9),console.error(t.t0);case 25:return t.prev=25,this.$emit("reserve",!1),this.isReserving=!1,t.finish(25);case 29:case"end":return t.stop()}},t,this,[[9,22,25,29]])}));return function(){return t.apply(this,arguments)}}()})}),l=h,d=(s("1f0f"),s("2877")),p=Object(d["a"])(l,u,c,!1,null,"6fb8d19c",null);p.options.__file="NdtSeat.vue";var m=p.exports,f=s("30c1"),v=s("c1df"),S=s.n(v),_={name:"NDTSeatmap",components:{NdtSeat:m,VueCountdown:f["a"]},props:{readOnly:{type:Boolean,default:!1},explanation:{type:Boolean,default:!0}},data:function(t){return{selected:null,fetchingSeatmap:!1,reserving:!1,updateTimer:null}},computed:Object(r["a"])({},Object(o["c"])({width:"seatmap/width",height:"seatmap/height",available:"seatmap/available",seats:"seatmap/seats",user:"user/user",mySeat:"seatmap/mySeat",token:"auth/token"}),{reservationTime:function(){if(this.mySeat){var t=S()(),e=S()(this.mySeat.reserved),s=S.a.duration(e.diff(t));return s.asMilliseconds()}return 0},mySeatAvailable:function(){return!!this.mySeat&&this.reservationTime>0}}),methods:Object(r["a"])({},Object(o["b"])({setSeats:"seatmap/setSeats",setWidth:"seatmap/setWidth",setHeight:"seatmap/setHeight"}),{clearReservation:function(){var t=Object(i["a"])(regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:if(!this.mySeat){t.next=7;break}return this.reserve(!0),t.next=4,this.$api.delete("seatmap/reserve/".concat(this.mySeat.id),{owner:this.token});case 4:return t.next=6,this.fetchSeatmap();case 6:this.reserve(!1);case 7:case"end":return t.stop()}},t,this)}));return function(){return t.apply(this,arguments)}}(),reserve:function(t){this.reserving=t},reserved:function(t){this.$emit("complete-step",t)},fetchSeatmap:function(){var t=Object(i["a"])(regeneratorRuntime.mark(function t(){var e;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return this.seats&&this.seats.length||(this.fetchingSeatmap=!0),t.next=3,this.$api.get("seatmap");case 3:e=t.sent,this.setSeats(e.seats),this.setWidth(e.width),this.setHeight(e.height),this.fetchingSeatmap&&(this.fetchingSeatmap=!1);case 8:case"end":return t.stop()}},t,this)}));return function(){return t.apply(this,arguments)}}()}),mounted:function(){var t=this;this.fetchSeatmap(),this.updateTimer=setInterval(function(){return t.fetchSeatmap()},6e4)}},y=_,g=(s("6c33"),Object(d["a"])(y,a,n,!1,null,"4cb95a04",null));g.options.__file="NdtSeatmap.vue";e["a"]=g.exports},"1f0f":function(t,e,s){"use strict";var a=s("83f7"),n=s.n(a);n.a},3068:function(t,e,s){"use strict";s.r(e);var a=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"NDT-Page"},[s("h1",{staticClass:"NDT-Page__Header"},[s("span",[t._v("Seatmap")]),s("a",{attrs:{href:"#"},on:{click:function(e){return e.preventDefault(),t.maximize(e)}}},[s("icon",{attrs:{icon:"vector-square"}})],1)]),s("div",{ref:"seatmap",staticClass:"NDT-Page__Body"},[s("ndt-seatmap",{attrs:{"read-only":"",explanation:!1}})],1)])},n=[],i=(s("cadf"),s("551c"),s("097d"),s("1caf")),r={name:"Seatmap",components:{NdtSeatmap:i["a"]},methods:{maximize:function(){var t=this.$refs.seatmap;t.requestFullscreen?t.requestFullscreen():t.webkitRequestFullScreen()}}},o=r,u=(s("0c15"),s("2877")),c=Object(u["a"])(o,a,n,!1,null,"28761445",null);c.options.__file="Seatmap.vue";e["default"]=c.exports},"30c1":function(t,e,s){"use strict";
/*!
 * vue-countdown v1.0.1
 * https://xkeshi.github.io/vue-countdown
 *
 * Copyright 2017-present Chen Fengyuan
 * Released under the MIT license
 *
 * Date: 2018-09-06T13:42:33.119Z
 */var a=1e3,n=60*a,i=60*n,r=24*i,o={name:"countdown",data:function(){return{count:0,counting:!1,endTime:0}},props:{autoStart:{type:Boolean,default:!0},emitEvents:{type:Boolean,default:!0},interval:{type:Number,default:1e3},leadingZero:{type:Boolean,default:!0},now:{type:Function,default:function(){return Date.now()}},time:{type:Number,default:0,validator:function(t){return t>=0}},tag:{type:String,default:"span"}},computed:{days:function(){return Math.floor(this.count/r)},hours:function(){return Math.floor(this.count%r/i)},minutes:function(){return Math.floor(this.count%i/n)},seconds:function(){var t=this.interval,e=this.count%n/a;return t<10?parseFloat(e.toFixed(3)):t>=10&&t<100?parseFloat(e.toFixed(2)):t>=100&&t<1e3?parseFloat(e.toFixed(1)):Math.floor(e)},totalDays:function(){return this.days},totalHours:function(){return Math.floor(this.count/i)},totalMinutes:function(){return Math.floor(this.count/n)},totalSeconds:function(){var t=this.interval,e=this.count/a;return t<10?parseFloat(e.toFixed(3)):t>=10&&t<100?parseFloat(e.toFixed(2)):t>=100&&t<1e3?parseFloat(e.toFixed(1)):Math.floor(e)}},render:function(t){var e=this,s=function(t){return e.leadingZero&&t<10?"0".concat(t):t};return t(this.tag,this.$scopedSlots.default?[this.$scopedSlots.default({days:s(this.days),hours:s(this.hours),minutes:s(this.minutes),seconds:s(this.seconds),totalDays:s(this.totalDays),totalHours:s(this.totalHours),totalMinutes:s(this.totalMinutes),totalSeconds:s(this.totalSeconds)})]:this.$slots.default)},methods:{init:function(){var t=this,e=this.time;e>0&&(this.count=e,this.endTime=this.now()+e,this.autoStart&&this.$nextTick(function(){t.start()}))},start:function(){this.counting||(this.emitEvents&&this.$emit("countdownstart"),this.counting=!0,this.next())},pause:function(){this.counting&&(this.emitEvents&&this.$emit("countdownpause"),this.counting=!1,clearTimeout(this.timeout))},next:function(){this.timeout=setTimeout(this.step.bind(this),this.interval)},step:function(){this.counting&&(this.count>this.interval?(this.count-=this.interval,this.emitEvents&&this.count>0&&this.$emit("countdownprogress",{days:this.days,hours:this.hours,minutes:this.minutes,seconds:this.seconds,totalDays:this.totalDays,totalHours:this.totalHours,totalMinutes:this.totalMinutes,totalSeconds:this.totalSeconds}),this.next()):(this.count=0,this.stop()))},stop:function(){this.counting=!1,clearTimeout(this.timeout),this.timeout=void 0,this.emitEvents&&this.$emit("countdownend")},update:function(){this.counting&&(this.count=Math.max(0,this.endTime-this.now()))}},watch:{time:function(){this.init()}},created:function(){this.init()},mounted:function(){window.addEventListener("focus",this.onFocus=this.update.bind(this))},beforeDestroy:function(){window.removeEventListener("focus",this.onFocus),clearTimeout(this.timeout)}};e["a"]=o},"31f3":function(t,e,s){},"6c33":function(t,e,s){"use strict";var a=s("cb35"),n=s.n(a);n.a},"83f7":function(t,e,s){},cb35:function(t,e,s){}}]);
//# sourceMappingURL=seatmap.ce7af39d.js.map